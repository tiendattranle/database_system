<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>M√°y in</title>
	</head>
	<link
		rel="shortcut icon"
		href="static/images/HCMUT_official_logo.ico"
		type="image/x-icon" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/choose_printer_admin.css') }}" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/navbar.css') }}" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/chatbox.css') }}" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/noti_box.css') }}" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/chatbox_admin.css') }}" />
	<body>
		<div id="root"></div>
		<link
			href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap"
			rel="stylesheet" />
		<link
			href="https://fonts.googleapis.com/css2?family=Itim&display=swap"
			rel="stylesheet" />
		<!-- nav bar -->
		<div id="navbar">
			<div
				id="logo"
				style="
					width: 285.6px;
					height: 57.6px;
					left: 40px;
					top: 5.6px;
					position: absolute;
				">
				<div
					style="
						width: 255px;
						height: 53.6px;
						left: 17.6px;
						top: 0px;
						position: absolute;
						background: #142c64;
						border-radius: 16px;
					"></div>
				<img
					style="
						width: 88.8px;
						height: 56.8px;
						left: 0px;
						top: 0.8px;
						position: absolute;
					"
					src="{{ url_for('static', filename='images/01_logobachkhoatoi 1.png') }}" />
				<div
					style="
						width: 178px;
						height: 49px;
						left: 85px;
						top: 0px;
						position: absolute;
						color: white;
						font-size: 22.4px;
						font-family: Montserrat;
						font-weight: 700;
						word-wrap: break-word;
					">
					E-bookstore
				</div>
			</div>
			<div class="nav-block">
				<script>
					function openMenu(x) {
						x.classList.toggle("change");
						const menu = document.getElementById("menu");
						if (menu.classList.contains("appear")) {
							menu.classList.remove("appear");
						} else {
							menu.classList.add("appear");
						}
					}
				</script>
				<div id="menu-icon" onclick="openMenu(this)">
					<div id="bar1"></div>
					<div id="bar2"></div>
					<div id="bar3"></div>
				</div>
				<ul id="menu">
					<li onClick="window.location.href='homescreen_admin';">TRANG CH·ª¶</li>
					<li>B·∫¢NG ƒêI·ªÄU KHI·ªÇN</li>
					<li
						onClick="window.location.href='choose_printer_admin';"
						class="index-page">
						QU·∫¢N L√ù M√ÅY IN
					</li>
					<li onClick="window.location.href='admin_printing_history';">
						L·ªäCH S·ª¨ IN
					</li>
					<li>L·ªäCH S·ª¨ MUA GI·∫§Y</li>
				</ul>
			</div>
			<div id="noti-account">
				<div id="noti">
					<svg
						id="circle"
						width="18"
						height="20"
						viewBox="0 0 18 20"
						fill="none"
						xmlns="http://www.w3.org/2000/svg">
						<path
							id="Vector"
							d="M12 15V16C12 17.6569 10.6569 19 9 19C7.34315 19 6 17.6569 6 16V15M12 15H6M12 15H15.5905C15.973 15 16.1652 15 16.3201 14.9478C16.616 14.848 16.8475 14.6156 16.9473 14.3198C16.9997 14.1643 16.9997 13.9715 16.9997 13.5859C16.9997 13.4172 16.9995 13.3329 16.9863 13.2524C16.9614 13.1004 16.9024 12.9563 16.8126 12.8312C16.7651 12.7651 16.7048 12.7048 16.5858 12.5858L16.1963 12.1963C16.0706 12.0706 16 11.9001 16 11.7224V8C16 4.134 12.866 0.999991 9 1C5.13401 1.00001 2 4.13401 2 8V11.7224C2 11.9002 1.92924 12.0706 1.80357 12.1963L1.41406 12.5858C1.29476 12.7051 1.23504 12.765 1.1875 12.8312C1.09766 12.9564 1.03815 13.1004 1.0132 13.2524C1 13.3329 1 13.4172 1 13.586C1 13.9715 1 14.1642 1.05245 14.3197C1.15225 14.6156 1.3848 14.848 1.68066 14.9478C1.83556 15 2.02701 15 2.40956 15H6"
							stroke="black"
							stroke-width="1.6"
							stroke-linecap="round"
							stroke-linejoin="round" />
					</svg>
					<svg
						id="bell"
						width="42"
						height="41"
						viewBox="0 0 42 41"
						fill="none"
						xmlns="http://www.w3.org/2000/svg">
						<path
							id="Ellipse 3230"
							d="M41 20.5C41 31.5457 32.0457 40.5 21 40.5C9.9543 40.5 1 31.5457 1 20.5C1 9.4543 9.9543 0.5 21 0.5C32.0457 0.5 41 9.4543 41 20.5Z"
							stroke="black" />
					</svg>
					<div id="notification-box" class="hidden">
						<div class="notification-header">Th√¥ng b√°o</div>
						<ul class="notification-list">
							{% if notifications %} {% for notification in notifications %}
							<li>
								<span class="notification-title"
									>Th√¥ng b√°o {{ loop.index }}</span
								>
								<!-- Hi·ªÉn th·ªã s·ªë th·ª© t·ª± th√¥ng b√°o -->
								<p>{{ notification[0] }}</p>
								<!-- N·ªôi dung th√¥ng b√°o -->
								<div class="notification-footer">
									<span class="notification-time">{{ notification[1] }}</span>
									<!-- Th·ªùi gian th√¥ng b√°o -->
									<button class="notification-detail-btn">Xem chi ti·∫øt</button>
								</div>
							</li>
							{% endfor %} {% else %}
							<li>
								<p>Kh√¥ng c√≥ th√¥ng b√°o n√†o.</p>
								<!-- Th√¥ng b√°o khi kh√¥ng c√≥ d·ªØ li·ªáu -->
							</li>
							{% endif %}
						</ul>
					</div>
				</div>
				<div class="info-list">
					<ul>
						<li>
							<img
								src=""
								class="profile-img"
								alt="Profile Picture" />
							<div class="name">{{ name }}</div>
							<ul class="dropdown">
								<li><a>H·ªì s∆°</a></li>
								<li>
									<a>Ng√¥n ng·ªØ</a>
									<ul class="nextpage">
										<li>Ti·∫øng Vi·ªát</li>
										<li>English</li>
									</ul>
								</li>
								<li><a href="/">ƒêƒÉng xu·∫•t</a></li>
							</ul>
							<svg
								style="padding: 0 10px, 0 10px"
								width="10"
								height="5"
								viewBox="0 0 12 8"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
								style="margin-left: -5px">
								<path
									d="M1 1L6 6L11 1"
									stroke="black"
									stroke-width="1.6"
									stroke-linecap="round"
									stroke-linejoin="round" />
							</svg>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!-- script xem th√¥ng b√°o -->
		<script>
			// X·ª≠ l√Ω hi·ªÉn th·ªã/·∫©n b·∫£ng th√¥ng b√°o khi nh·∫•n v√†o chu√¥ng
			document.getElementById("noti").addEventListener("click", function (e) {
				e.stopPropagation();
				const notificationBox = document.getElementById("notification-box");
				notificationBox.classList.toggle("active");
			});

			document.addEventListener("click", function (e) {
				const notificationBox = document.getElementById("notification-box");
				const noti = document.getElementById("noti");
				if (!noti.contains(e.target) && !notificationBox.contains(e.target)) {
					notificationBox.classList.remove("active");
				}
			});

			document
				.getElementById("notification-box")
				.addEventListener("click", function (e) {
					e.stopPropagation();
				});
		</script>
		<!-- ch·ªçn m√°y in -->
		<div class="container">
			<!-- Sidebar (C·ªôt b√™n tr√°i) -->
			<div class="sidebar">
				<div class="header">Vui l√≤ng ch·ªçn m√°y in</div>
				<div class="img-container">
					<img
						class="img-responsive"
						src="{{ url_for('static', filename='images/icon_map.png') }}"
						alt="Ch·ªçn m√°y in" />
				</div>
				<!-- Ch·ªçn c∆° s·ªü -->
				<div class="section-title">C∆° s·ªü</div>
				<div class="radio-group">
					<div class="custom-radio">
						<input
							type="radio"
							id="co-so-ly-thuong-kiet"
							name="co-so"
							value="Co-so-Ly-Thuong-Kiet" />
						<label for="co-so-ly-thuong-kiet">C∆° s·ªü L√Ω Th∆∞·ªùng Ki·ªát</label>
					</div>
					<div class="custom-radio">
						<input
							type="radio"
							id="co-so-di-an"
							name="co-so"
							value="Co-so-Di-An" />
						<label for="co-so-di-an">C∆° s·ªü Dƒ© An</label>
					</div>
				</div>

				<hr />

				<!-- Ch·ªçn t√≤a -->
				<div class="section-title">T√≤a</div>
				<div id="section-toa" style="display: none">
					<div class="radio-group1">
						<div class="custom-radio">
							<input type="radio" id="toa-a" name="toa" value="Toa-A" />
							<label for="toa-a">T√≤a B1</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-b" name="toa" value="Toa-B" />
							<label for="toa-b">T√≤a B2</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-c" name="toa" value="Toa-C" />
							<label for="toa-c">T√≤a B3</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-d" name="toa" value="Toa-D" />
							<label for="toa-d">T√≤a B4</label>
						</div>
					</div>
					<div class="radio-group1">
						<div class="custom-radio">
							<input type="radio" id="toa-e" name="toa" value="Toa-E" />
							<label for="toa-e">T√≤a B5</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-f" name="toa" value="Toa-F" />
							<label for="toa-f">T√≤a B6</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-g" name="toa" value="Toa-G" />
							<label for="toa-g">T√≤a B7</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-h" name="toa" value="Toa-H" />
							<label for="toa-h">T√≤a B8</label>
						</div>
					</div>
					<div class="radio-group1">
						<div class="custom-radio">
							<input type="radio" id="toa-i" name="toa" value="Toa-I" />
							<label for="toa-i">T√≤a B9</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-j" name="toa" value="Toa-J" />
							<label for="toa-j">T√≤a B10</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-k" name="toa" value="Toa-K" />
							<label for="toa-k">T√≤a B11</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-l" name="toa" value="Toa-L" />
							<label for="toa-l">T√≤a B12</label>
						</div>
					</div>
				</div>

				<hr />

				<!-- Ch·ªçn ph√≤ng -->
				<div class="section-title">Ph√≤ng</div>
				<div id="section-phong" style="display: none">
					<div class="radio-group1">
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b6-303"
								name="phong"
								value="Phong-B6-303" />
							<label for="phong-b6-303">B6 - 303</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b6-304"
								name="phong"
								value="Phong-B6-304" />
							<label for="phong-b6-304">B6 - 304</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b6-305"
								name="phong"
								value="Phong-B6-305" />
							<label for="phong-b6-305">B6 - 305</label>
						</div>
					</div>

					<div class="radio-group1">
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-101"
								name="phong"
								value="Phong-B7-101" />
							<label for="phong-b7-101">B7 - 101</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-102"
								name="phong"
								value="Phong-B7-102" />
							<label for="phong-b7-102">B7 - 102</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-103"
								name="phong"
								value="Phong-B7-103" />
							<label for="phong-b7-103">B7 - 103</label>
						</div>
					</div>

					<div class="radio-group1">
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-104"
								name="phong"
								value="Phong-B7-104" />
							<label for="phong-b7-104">B7 - 104</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-105"
								name="phong"
								value="Phong-B7-105" />
							<label for="phong-b7-105">B7 - 105</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-106"
								name="phong"
								value="Phong-B7-106" />
							<label for="phong-b7-106">B7 - 106</label>
						</div>
					</div>
				</div>
				<!-- script ch·ªçn c∆° s·ªü, t√≤a, ph√≤ng -->

				<!-- ch·ªçn r·ªìi hi·ªán theo th·ª© t·ª± -->
				<script>
					document.addEventListener("DOMContentLoaded", function () {
						const coSoRadios = document.querySelectorAll('input[name="co-so"]');
						const toaRadios = document.querySelectorAll('input[name="toa"]');
						const phongRadios = document.querySelectorAll(
							'input[name="phong"]'
						);
						const sectionToa = document.getElementById("section-toa");
						const sectionPhong = document.getElementById("section-phong");
						const printersContainer =
							document.getElementById("printers-container");

						// H√†m reset tr·∫°ng th√°i radio
						function resetRadios(radios) {
							radios.forEach((radio) => {
								radio.checked = false; // B·ªè ch·ªçn radio
								radio.dataset.checked = "false"; // ƒê·∫∑t tr·∫°ng th√°i kh√¥ng ƒë∆∞·ª£c ch·ªçn
							});
						}

						// Khi ch·ªçn c∆° s·ªü
						coSoRadios.forEach((radio) => {
							radio.addEventListener("click", function () {
								if (this.dataset.checked === "true") {
									// N·∫øu b·∫•m l·∫°i c√πng m·ªôt radio
									resetRadios(coSoRadios); // Reset t·∫•t c·∫£ radio c·ªßa C∆° s·ªü
									resetRadios(toaRadios); // Reset t·∫•t c·∫£ radio c·ªßa T√≤a
									resetRadios(phongRadios); // Reset t·∫•t c·∫£ radio c·ªßa Ph√≤ng
									sectionToa.style.display = "none"; // ·∫®n Section T√≤a
									sectionPhong.style.display = "none"; // ·∫®n Section Ph√≤ng
									printersContainer.style.visibility = "hidden"; // ·∫®n n·ªôi dung ch√≠nh
								} else {
									// N·∫øu ch·ªçn kh√°c
									resetRadios(coSoRadios); // Reset t·∫•t c·∫£ radio c·ªßa C∆° s·ªü
									this.dataset.checked = "true"; // ƒê·∫∑t tr·∫°ng th√°i cho radio hi·ªán t·∫°i
									this.checked = true;
									sectionToa.style.display = "block"; // Hi·ªán Section T√≤a
									sectionPhong.style.display = "none"; // ·∫®n Section Ph√≤ng
									printersContainer.style.visibility = "hidden"; // ·∫®n n·ªôi dung ch√≠nh
									resetRadios(toaRadios); // ƒê·∫£m b·∫£o radio c·ªßa T√≤a reset khi ch·ªçn C∆° s·ªü m·ªõi
									resetRadios(phongRadios); // ƒê·∫£m b·∫£o radio c·ªßa Ph√≤ng reset
								}
							});
						});

						// Khi ch·ªçn t√≤a
						toaRadios.forEach((radio) => {
							radio.addEventListener("click", function () {
								if (this.dataset.checked === "true") {
									// N·∫øu b·∫•m l·∫°i c√πng m·ªôt radio
									resetRadios(toaRadios); // Reset t·∫•t c·∫£ radio c·ªßa T√≤a
									resetRadios(phongRadios); // Reset t·∫•t c·∫£ radio c·ªßa Ph√≤ng
									sectionPhong.style.display = "none"; // ·∫®n Section Ph√≤ng
									printersContainer.style.visibility = "hidden"; // ·∫®n n·ªôi dung ch√≠nh
								} else {
									// N·∫øu ch·ªçn kh√°c
									resetRadios(toaRadios); // Reset t·∫•t c·∫£ radio c·ªßa T√≤a
									this.dataset.checked = "true"; // ƒê·∫∑t tr·∫°ng th√°i cho radio hi·ªán t·∫°i
									this.checked = true;
									sectionPhong.style.display = "block"; // Hi·ªán Section Ph√≤ng
									printersContainer.style.visibility = "hidden"; // ·∫®n n·ªôi dung ch√≠nh
									resetRadios(phongRadios); // ƒê·∫£m b·∫£o radio c·ªßa Ph√≤ng reset khi ch·ªçn T√≤a m·ªõi
								}
							});
						});

						// Khi ch·ªçn ph√≤ng
						phongRadios.forEach((radio) => {
							radio.addEventListener("click", function () {
								if (this.dataset.checked === "true") {
									// N·∫øu b·∫•m l·∫°i c√πng m·ªôt radio
									resetRadios(phongRadios); // Reset t·∫•t c·∫£ radio c·ªßa Ph√≤ng
									printersContainer.style.visibility = "hidden"; // ·∫®n n·ªôi dung ch√≠nh
								} else {
									// N·∫øu ch·ªçn kh√°c
									resetRadios(phongRadios); // Reset t·∫•t c·∫£ radio c·ªßa Ph√≤ng
									this.dataset.checked = "true"; // ƒê·∫∑t tr·∫°ng th√°i cho radio hi·ªán t·∫°i
									this.checked = true;
									printersContainer.style.visibility = "visible"; // Hi·ªán n·ªôi dung ch√≠nh
								}
							});
						});
					});
				</script>
			</div>
			<!-- Content ch√≠nh -->
			<div id="printers-container" class="printers-container">
				<!-- ƒê∆∞·ªùng d·∫´n ƒëi·ªÅu h∆∞·ªõng -->
				<div class="breadcrumb">
					C∆° s·ªü L√Ω Th∆∞·ªùng Ki·ªát > T√≤a B1 > Ph√≤ng B1 - 301
				</div>
				<!-- Danh s√°ch m√°y in -->
				<div class="printers-grid">
					{% for printer in printers %} {% if printer[4].strip() == "T√≤a B1" %}
					<div class="printer-card" data-printer-id="{{ printer[0] }}">
						<img
							src="{{ url_for('static', filename='images/icon_printer.png') }}" />
						<p class="printer-id">B130{{ 10 + loop.index }}</p>
						<!-- Hi·ªÉn th·ªã ID t√πy ch·ªânh -->
						{% if printer[1] == "S·∫µn s√†ng" %}
						<p class="status status-available">S·∫¥N S√ÄNG</p>
						{% elif printer[1] == "ƒêang in" %}
						<p class="status status-busy">ƒêANG IN</p>
						{% elif printer[1] == "V√¥ hi·ªáu h√≥a" %}
						<p class="status status-disabled">V√î HI·ªÜU H√ìA</p>
						{% else %}
						<p class="status status-unknown">KH√îNG X√ÅC ƒê·ªäNH</p>
						{% endif %}
					</div>
					{% endif %} {% endfor %}
				</div>
			</div>
			<!-- c·∫•u h√¨nh m√°y in -->
			<div class="config-panel">
				<div class="header2">C·∫•u h√¨nh m√°y in</div>
				<div class="content">
					<img
						src="{{ url_for('static', filename='images/cauhinhmayin.png') }}"
						class="content-image"
						style="display: none" />
				</div>
				<div class="footer">
					<span>V√¥ hi·ªáu h√≥a</span>
					<label class="switch">
						<input type="checkbox" id="disable-printer-switch" />
						<span class="slider"></span>
					</label>
				</div>
			</div>
			<!-- script hi·ªán c·∫•u h√¨nh in v√† v√¥ hi·ªáu h√≥a -->
			<script>
				document.addEventListener("DOMContentLoaded", function () {
					const printerCards = document.querySelectorAll(".printer-card");
					const contentImage = document.querySelector(".content-image");
					const disableSwitch = document.getElementById(
						"disable-printer-switch"
					);
					let selectedPrinter = null; // Bi·∫øn l∆∞u m√°y in ƒëang ch·ªçn

					printerCards.forEach((printerCard) => {
						printerCard.addEventListener("click", function () {
							if (this.classList.contains("selected")) {
								// B·ªè ch·ªçn n·∫øu nh·∫•n v√†o m√°y in ƒëang ƒë∆∞·ª£c ch·ªçn
								this.classList.remove("selected");
								selectedPrinter = null;
								contentImage.style.display = "none";
								disableSwitch.checked = false; // Reset tr·∫°ng th√°i switch
								disableSwitch.disabled = true; // Disable switch
							} else {
								// Ch·ªçn m√°y in m·ªõi
								printerCards.forEach((card) =>
									card.classList.remove("selected")
								);
								this.classList.add("selected");
								selectedPrinter = this;

								const printerId = this.dataset.printerId; // L·∫•y ID m√°y in t·ª´ thu·ªôc t√≠nh data
								const statusElement = this.querySelector(".status"); // L·∫•y tr·∫°ng th√°i c·ªßa m√°y in

								// Hi·ªÉn th·ªã h√¨nh ·∫£nh c·∫•u h√¨nh
								contentImage.src = `{{ url_for('static', filename='images/cauhinhmayin.png') }}`;
								contentImage.style.display = "block";

								// C·∫≠p nh·∫≠t tr·∫°ng th√°i c√¥ng t·∫Øc
								if (statusElement.classList.contains("status-disabled")) {
									disableSwitch.checked = true; // B·∫≠t c√¥ng t·∫Øc
								} else {
									disableSwitch.checked = false; // T·∫Øt c√¥ng t·∫Øc
								}

								disableSwitch.disabled = false; // B·∫≠t c√¥ng t·∫Øc ƒë·ªÉ c√≥ th·ªÉ thao t√°c
							}
						});
					});

					// L·∫Øng nghe thay ƒë·ªïi tr·∫°ng th√°i c·ªßa c√¥ng t·∫Øc
					disableSwitch.addEventListener("change", function () {
						if (!selectedPrinter) return; // N·∫øu kh√¥ng c√≥ m√°y in n√†o ƒë∆∞·ª£c ch·ªçn

						const printerId = selectedPrinter.dataset.printerId; // L·∫•y ID c·ªßa m√°y in ƒë∆∞·ª£c ch·ªçn
						const newStatus = this.checked ? "V√¥ hi·ªáu h√≥a" : "S·∫µn s√†ng"; // T√≠nh tr·∫°ng th√°i m·ªõi d·ª±a tr√™n c√¥ng t·∫Øc

						// C·∫≠p nh·∫≠t tr·∫°ng th√°i giao di·ªán
						const statusElement = selectedPrinter.querySelector(".status");
						if (this.checked) {
							statusElement.textContent = "V√î HI·ªÜU H√ìA";
							statusElement.classList.remove("status-available", "status-busy");
							statusElement.classList.add("status-disabled");
						} else {
							statusElement.textContent = "S·∫¥N S√ÄNG";
							statusElement.classList.remove("status-disabled", "status-busy");
							statusElement.classList.add("status-available");
						}

						// G·ª≠i y√™u c·∫ßu c·∫≠p nh·∫≠t tr·∫°ng th√°i l√™n server (Flask)
						fetch("/update_printer_status", {
							method: "POST",
							headers: {
								"Content-Type": "application/json",
							},
							body: JSON.stringify({
								printer_id: printerId,
								status: newStatus,
							}),
						})
							.then((response) => response.json())
							.then((data) => {
								if (data.success) {
									console.log(
										`M√°y in ${printerId} ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t tr·∫°ng th√°i.`
									);
								} else {
									console.log(
										`L·ªói khi c·∫≠p nh·∫≠t tr·∫°ng th√°i m√°y in ${printerId}`
									);
								}
							})
							.catch((error) => {
								console.error("C√≥ l·ªói khi g·ª≠i y√™u c·∫ßu:", error);
							});
					});
				});
			</script>
		</div>

		<!-- chatbox admin -->
		<div
			id="chat-icon"
			draggable="true"
			onmousedown="this.style.cursor='grabbing'"
			onmouseup="this.style.cursor='grab'"
			ondragstart="event.dataTransfer.setDragImage(new Image(), 0, 0);"
			ondrag="if(event.clientX > 0 && event.clientY > 0) { this.style.left = event.clientX - 25 + 'px'; this.style.top = event.clientY - 25 + 'px'; this.style.position='fixed'; }"
			onclick="document.getElementById('chat-box').style.display = 'flex';">
			üí¨
		</div>

		<!-- Chat Box -->
		<div id="chat-box">
			<!-- Chat List -->
			<div id="chat-list">
				<div class="chat-header">
					<span>ƒêo·∫°n chat</span>
					<button
						onclick="document.getElementById('chat-box').style.display = 'none';">
						√ó
					</button>
				</div>
				<ul>
					<li onclick="openChat('Anh Khoa', 'T√¥i c·∫ßn h·ªó tr·ª£ ·ªü m√°y in s·ªë 4');">
						<img src="{{ url_for('static', filename='images/anhkhoa.png') }}" />
						<div>
							<span class="chat-name">Anh Khoa</span>
							<p class="chat-message">T√¥i c·∫ßn h·ªó tr·ª£...</p>
						</div>
					</li>
					<li
						onclick="openChat('Ti·∫øn ƒê·∫°t', 'T√¥i c·∫ßn h·ªó tr·ª£ v·ªõi m√°y t√≠nh m·∫°ng');">
						<img src="{{ url_for('static', filename='images/dat.png') }}" />
						<div>
							<span class="chat-name">Ti·∫øn ƒê·∫°t</span>
							<p class="chat-message">T√¥i c·∫ßn h·ªó tr·ª£...</p>
						</div>
					</li>
				</ul>
			</div>

			<!-- Chat Conversation -->
			<div id="chat-conversation" style="display: none">
				<div class="chat-header">
					<button onclick="backToChatList()">‚Üê</button>
					<span id="conversation-name"></span>
				</div>
				<div id="messages">
					<!-- Messages dynamically injected -->
				</div>
				<div class="chat-input">
					<input
						type="text"
						placeholder="Nh·∫≠p tin nh·∫Øn..."
						id="message-input" />
					<button onclick="sendMessage()">G·ª≠i</button>
				</div>
			</div>
		</div>
		<!-- script chatbox -->
		<script>
			const chatIcon = document.getElementById("chat-icon");
			const chatBox = document.getElementById("chat-box");
			const chatList = document.getElementById("chat-list");
			const chatConversation = document.getElementById("chat-conversation");
			const conversationName = document.getElementById("conversation-name");
			const messages = document.getElementById("messages");
			const messageInput = document.getElementById("message-input");

			let offsetX, offsetY;

			// Data for the messages
			const chatData = {
				"Anh Khoa": ["T√¥i c·∫ßn h·ªó tr·ª£ ·ªü m√°y in s·ªë 4", "M√°y in b·ªã l·ªói gi·∫•y"],
				"Ti·∫øn ƒê·∫°t": [
					"T√¥i c·∫ßn h·ªó tr·ª£ v·ªõi m√°y t√≠nh m·∫°ng",
					"M·∫°ng b·ªã ng·∫Øt k·∫øt n·ªëi",
				],
			};
			// Toggle chat box visibility
			function toggleChat() {
				chatBox.classList.toggle("hidden");
			}

			// Close chat box
			function closeChat() {
				chatBox.classList.add("hidden");
			}

			function openChat(name, initialMessage) {
				// Hide chat list and show chat conversation
				document.getElementById("chat-list").style.display = "none";
				document.getElementById("chat-conversation").style.display = "flex";

				// Set the conversation name
				document.getElementById("conversation-name").textContent = name;

				// Show all messages for the selected chat
				const messages = chatData[name]
					.map((message) => `<p><strong>${name}:</strong> ${message}</p>`)
					.join("");

				// Display all the messages
				document.getElementById("messages").innerHTML = messages;
			}

			// Back to the chat list
			function backToChatList() {
				document.getElementById("chat-conversation").style.display = "none";
				document.getElementById("chat-list").style.display = "block";
			}

			// Send message
			function sendMessage() {
				const text = document.getElementById("message-input").value.trim();
				if (text) {
					const message = `<p><strong>B·∫°n:</strong> ${text}</p>`;
					document.getElementById("messages").innerHTML += message;
					document.getElementById("message-input").value = "";
				}
			}

			// Dragging the chat icon
			function startDrag(e) {
				offsetX = e.clientX - chatIcon.offsetLeft;
				offsetY = e.clientY - chatIcon.offsetTop;
				chatIcon.style.cursor = "grabbing";
			}

			function endDrag(e) {
				chatIcon.style.left = `${e.clientX - offsetX}px`;
				chatIcon.style.top = `${e.clientY - offsetY}px`;
				chatIcon.style.cursor = "grab";
			}

			// Add click listener to open chat box
			chatIcon.addEventListener("click", toggleChat);
		</script>
	</body>
</html>
