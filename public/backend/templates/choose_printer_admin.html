<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Máy in</title>
	</head>
	<link
		rel="shortcut icon"
		href="static/images/HCMUT_official_logo.ico"
		type="image/x-icon" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/choose_printer_admin.css') }}" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/navbar.css') }}" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/chatbox.css') }}" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/noti_box.css') }}" />
	<link
		rel="stylesheet"
		href="{{ url_for('static', filename='css/chatbox_admin.css') }}" />
	<body>
		<div id="root"></div>
		<link
			href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap"
			rel="stylesheet" />
		<link
			href="https://fonts.googleapis.com/css2?family=Itim&display=swap"
			rel="stylesheet" />
		<!-- nav bar -->
		<div id="navbar">
			<div
				id="logo"
				style="
					width: 285.6px;
					height: 57.6px;
					left: 40px;
					top: 5.6px;
					position: absolute;
				">
				<div
					style="
						width: 255px;
						height: 53.6px;
						left: 17.6px;
						top: 0px;
						position: absolute;
						background: #142c64;
						border-radius: 16px;
					"></div>
				<img
					style="
						width: 88.8px;
						height: 56.8px;
						left: 0px;
						top: 0.8px;
						position: absolute;
					"
					src="{{ url_for('static', filename='images/01_logobachkhoatoi 1.png') }}" />
				<div
					style="
						width: 178px;
						height: 49px;
						left: 85px;
						top: 0px;
						position: absolute;
						color: white;
						font-size: 22.4px;
						font-family: Montserrat;
						font-weight: 700;
						word-wrap: break-word;
					">
					E-bookstore
				</div>
			</div>
			<div class="nav-block">
				<script>
					function openMenu(x) {
						x.classList.toggle("change");
						const menu = document.getElementById("menu");
						if (menu.classList.contains("appear")) {
							menu.classList.remove("appear");
						} else {
							menu.classList.add("appear");
						}
					}
				</script>
				<div id="menu-icon" onclick="openMenu(this)">
					<div id="bar1"></div>
					<div id="bar2"></div>
					<div id="bar3"></div>
				</div>
				<ul id="menu">
					<li onClick="window.location.href='homescreen_admin';">TRANG CHỦ</li>
					<li>BẢNG ĐIỀU KHIỂN</li>
					<li
						onClick="window.location.href='choose_printer_admin';"
						class="index-page">
						QUẢN LÝ MÁY IN
					</li>
					<li onClick="window.location.href='admin_printing_history';">
						LỊCH SỬ IN
					</li>
					<li>LỊCH SỬ MUA GIẤY</li>
				</ul>
			</div>
			<div id="noti-account">
				<div id="noti">
					<svg
						id="circle"
						width="18"
						height="20"
						viewBox="0 0 18 20"
						fill="none"
						xmlns="http://www.w3.org/2000/svg">
						<path
							id="Vector"
							d="M12 15V16C12 17.6569 10.6569 19 9 19C7.34315 19 6 17.6569 6 16V15M12 15H6M12 15H15.5905C15.973 15 16.1652 15 16.3201 14.9478C16.616 14.848 16.8475 14.6156 16.9473 14.3198C16.9997 14.1643 16.9997 13.9715 16.9997 13.5859C16.9997 13.4172 16.9995 13.3329 16.9863 13.2524C16.9614 13.1004 16.9024 12.9563 16.8126 12.8312C16.7651 12.7651 16.7048 12.7048 16.5858 12.5858L16.1963 12.1963C16.0706 12.0706 16 11.9001 16 11.7224V8C16 4.134 12.866 0.999991 9 1C5.13401 1.00001 2 4.13401 2 8V11.7224C2 11.9002 1.92924 12.0706 1.80357 12.1963L1.41406 12.5858C1.29476 12.7051 1.23504 12.765 1.1875 12.8312C1.09766 12.9564 1.03815 13.1004 1.0132 13.2524C1 13.3329 1 13.4172 1 13.586C1 13.9715 1 14.1642 1.05245 14.3197C1.15225 14.6156 1.3848 14.848 1.68066 14.9478C1.83556 15 2.02701 15 2.40956 15H6"
							stroke="black"
							stroke-width="1.6"
							stroke-linecap="round"
							stroke-linejoin="round" />
					</svg>
					<svg
						id="bell"
						width="42"
						height="41"
						viewBox="0 0 42 41"
						fill="none"
						xmlns="http://www.w3.org/2000/svg">
						<path
							id="Ellipse 3230"
							d="M41 20.5C41 31.5457 32.0457 40.5 21 40.5C9.9543 40.5 1 31.5457 1 20.5C1 9.4543 9.9543 0.5 21 0.5C32.0457 0.5 41 9.4543 41 20.5Z"
							stroke="black" />
					</svg>
					<div id="notification-box" class="hidden">
						<div class="notification-header">Thông báo</div>
						<ul class="notification-list">
							{% if notifications %} {% for notification in notifications %}
							<li>
								<span class="notification-title"
									>Thông báo {{ loop.index }}</span
								>
								<!-- Hiển thị số thứ tự thông báo -->
								<p>{{ notification[0] }}</p>
								<!-- Nội dung thông báo -->
								<div class="notification-footer">
									<span class="notification-time">{{ notification[1] }}</span>
									<!-- Thời gian thông báo -->
									<button class="notification-detail-btn">Xem chi tiết</button>
								</div>
							</li>
							{% endfor %} {% else %}
							<li>
								<p>Không có thông báo nào.</p>
								<!-- Thông báo khi không có dữ liệu -->
							</li>
							{% endif %}
						</ul>
					</div>
				</div>
				<div class="info-list">
					<ul>
						<li>
							<img
								src=""
								class="profile-img"
								alt="Profile Picture" />
							<div class="name">{{ name }}</div>
							<ul class="dropdown">
								<li><a>Hồ sơ</a></li>
								<li>
									<a>Ngôn ngữ</a>
									<ul class="nextpage">
										<li>Tiếng Việt</li>
										<li>English</li>
									</ul>
								</li>
								<li><a href="/">Đăng xuất</a></li>
							</ul>
							<svg
								style="padding: 0 10px, 0 10px"
								width="10"
								height="5"
								viewBox="0 0 12 8"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
								style="margin-left: -5px">
								<path
									d="M1 1L6 6L11 1"
									stroke="black"
									stroke-width="1.6"
									stroke-linecap="round"
									stroke-linejoin="round" />
							</svg>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!-- script xem thông báo -->
		<script>
			// Xử lý hiển thị/ẩn bảng thông báo khi nhấn vào chuông
			document.getElementById("noti").addEventListener("click", function (e) {
				e.stopPropagation();
				const notificationBox = document.getElementById("notification-box");
				notificationBox.classList.toggle("active");
			});

			document.addEventListener("click", function (e) {
				const notificationBox = document.getElementById("notification-box");
				const noti = document.getElementById("noti");
				if (!noti.contains(e.target) && !notificationBox.contains(e.target)) {
					notificationBox.classList.remove("active");
				}
			});

			document
				.getElementById("notification-box")
				.addEventListener("click", function (e) {
					e.stopPropagation();
				});
		</script>
		<!-- chọn máy in -->
		<div class="container">
			<!-- Sidebar (Cột bên trái) -->
			<div class="sidebar">
				<div class="header">Vui lòng chọn máy in</div>
				<div class="img-container">
					<img
						class="img-responsive"
						src="{{ url_for('static', filename='images/icon_map.png') }}"
						alt="Chọn máy in" />
				</div>
				<!-- Chọn cơ sở -->
				<div class="section-title">Cơ sở</div>
				<div class="radio-group">
					<div class="custom-radio">
						<input
							type="radio"
							id="co-so-ly-thuong-kiet"
							name="co-so"
							value="Co-so-Ly-Thuong-Kiet" />
						<label for="co-so-ly-thuong-kiet">Cơ sở Lý Thường Kiệt</label>
					</div>
					<div class="custom-radio">
						<input
							type="radio"
							id="co-so-di-an"
							name="co-so"
							value="Co-so-Di-An" />
						<label for="co-so-di-an">Cơ sở Dĩ An</label>
					</div>
				</div>

				<hr />

				<!-- Chọn tòa -->
				<div class="section-title">Tòa</div>
				<div id="section-toa" style="display: none">
					<div class="radio-group1">
						<div class="custom-radio">
							<input type="radio" id="toa-a" name="toa" value="Toa-A" />
							<label for="toa-a">Tòa B1</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-b" name="toa" value="Toa-B" />
							<label for="toa-b">Tòa B2</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-c" name="toa" value="Toa-C" />
							<label for="toa-c">Tòa B3</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-d" name="toa" value="Toa-D" />
							<label for="toa-d">Tòa B4</label>
						</div>
					</div>
					<div class="radio-group1">
						<div class="custom-radio">
							<input type="radio" id="toa-e" name="toa" value="Toa-E" />
							<label for="toa-e">Tòa B5</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-f" name="toa" value="Toa-F" />
							<label for="toa-f">Tòa B6</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-g" name="toa" value="Toa-G" />
							<label for="toa-g">Tòa B7</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-h" name="toa" value="Toa-H" />
							<label for="toa-h">Tòa B8</label>
						</div>
					</div>
					<div class="radio-group1">
						<div class="custom-radio">
							<input type="radio" id="toa-i" name="toa" value="Toa-I" />
							<label for="toa-i">Tòa B9</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-j" name="toa" value="Toa-J" />
							<label for="toa-j">Tòa B10</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-k" name="toa" value="Toa-K" />
							<label for="toa-k">Tòa B11</label>
						</div>
						<div class="custom-radio">
							<input type="radio" id="toa-l" name="toa" value="Toa-L" />
							<label for="toa-l">Tòa B12</label>
						</div>
					</div>
				</div>

				<hr />

				<!-- Chọn phòng -->
				<div class="section-title">Phòng</div>
				<div id="section-phong" style="display: none">
					<div class="radio-group1">
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b6-303"
								name="phong"
								value="Phong-B6-303" />
							<label for="phong-b6-303">B6 - 303</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b6-304"
								name="phong"
								value="Phong-B6-304" />
							<label for="phong-b6-304">B6 - 304</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b6-305"
								name="phong"
								value="Phong-B6-305" />
							<label for="phong-b6-305">B6 - 305</label>
						</div>
					</div>

					<div class="radio-group1">
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-101"
								name="phong"
								value="Phong-B7-101" />
							<label for="phong-b7-101">B7 - 101</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-102"
								name="phong"
								value="Phong-B7-102" />
							<label for="phong-b7-102">B7 - 102</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-103"
								name="phong"
								value="Phong-B7-103" />
							<label for="phong-b7-103">B7 - 103</label>
						</div>
					</div>

					<div class="radio-group1">
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-104"
								name="phong"
								value="Phong-B7-104" />
							<label for="phong-b7-104">B7 - 104</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-105"
								name="phong"
								value="Phong-B7-105" />
							<label for="phong-b7-105">B7 - 105</label>
						</div>
						<div class="custom-radio">
							<input
								type="radio"
								id="phong-b7-106"
								name="phong"
								value="Phong-B7-106" />
							<label for="phong-b7-106">B7 - 106</label>
						</div>
					</div>
				</div>
				<!-- script chọn cơ sở, tòa, phòng -->

				<!-- chọn rồi hiện theo thứ tự -->
				<script>
					document.addEventListener("DOMContentLoaded", function () {
						const coSoRadios = document.querySelectorAll('input[name="co-so"]');
						const toaRadios = document.querySelectorAll('input[name="toa"]');
						const phongRadios = document.querySelectorAll(
							'input[name="phong"]'
						);
						const sectionToa = document.getElementById("section-toa");
						const sectionPhong = document.getElementById("section-phong");
						const printersContainer =
							document.getElementById("printers-container");

						// Hàm reset trạng thái radio
						function resetRadios(radios) {
							radios.forEach((radio) => {
								radio.checked = false; // Bỏ chọn radio
								radio.dataset.checked = "false"; // Đặt trạng thái không được chọn
							});
						}

						// Khi chọn cơ sở
						coSoRadios.forEach((radio) => {
							radio.addEventListener("click", function () {
								if (this.dataset.checked === "true") {
									// Nếu bấm lại cùng một radio
									resetRadios(coSoRadios); // Reset tất cả radio của Cơ sở
									resetRadios(toaRadios); // Reset tất cả radio của Tòa
									resetRadios(phongRadios); // Reset tất cả radio của Phòng
									sectionToa.style.display = "none"; // Ẩn Section Tòa
									sectionPhong.style.display = "none"; // Ẩn Section Phòng
									printersContainer.style.visibility = "hidden"; // Ẩn nội dung chính
								} else {
									// Nếu chọn khác
									resetRadios(coSoRadios); // Reset tất cả radio của Cơ sở
									this.dataset.checked = "true"; // Đặt trạng thái cho radio hiện tại
									this.checked = true;
									sectionToa.style.display = "block"; // Hiện Section Tòa
									sectionPhong.style.display = "none"; // Ẩn Section Phòng
									printersContainer.style.visibility = "hidden"; // Ẩn nội dung chính
									resetRadios(toaRadios); // Đảm bảo radio của Tòa reset khi chọn Cơ sở mới
									resetRadios(phongRadios); // Đảm bảo radio của Phòng reset
								}
							});
						});

						// Khi chọn tòa
						toaRadios.forEach((radio) => {
							radio.addEventListener("click", function () {
								if (this.dataset.checked === "true") {
									// Nếu bấm lại cùng một radio
									resetRadios(toaRadios); // Reset tất cả radio của Tòa
									resetRadios(phongRadios); // Reset tất cả radio của Phòng
									sectionPhong.style.display = "none"; // Ẩn Section Phòng
									printersContainer.style.visibility = "hidden"; // Ẩn nội dung chính
								} else {
									// Nếu chọn khác
									resetRadios(toaRadios); // Reset tất cả radio của Tòa
									this.dataset.checked = "true"; // Đặt trạng thái cho radio hiện tại
									this.checked = true;
									sectionPhong.style.display = "block"; // Hiện Section Phòng
									printersContainer.style.visibility = "hidden"; // Ẩn nội dung chính
									resetRadios(phongRadios); // Đảm bảo radio của Phòng reset khi chọn Tòa mới
								}
							});
						});

						// Khi chọn phòng
						phongRadios.forEach((radio) => {
							radio.addEventListener("click", function () {
								if (this.dataset.checked === "true") {
									// Nếu bấm lại cùng một radio
									resetRadios(phongRadios); // Reset tất cả radio của Phòng
									printersContainer.style.visibility = "hidden"; // Ẩn nội dung chính
								} else {
									// Nếu chọn khác
									resetRadios(phongRadios); // Reset tất cả radio của Phòng
									this.dataset.checked = "true"; // Đặt trạng thái cho radio hiện tại
									this.checked = true;
									printersContainer.style.visibility = "visible"; // Hiện nội dung chính
								}
							});
						});
					});
				</script>
			</div>
			<!-- Content chính -->
			<div id="printers-container" class="printers-container">
				<!-- Đường dẫn điều hướng -->
				<div class="breadcrumb">
					Cơ sở Lý Thường Kiệt > Tòa B1 > Phòng B1 - 301
				</div>
				<!-- Danh sách máy in -->
				<div class="printers-grid">
					{% for printer in printers %} {% if printer[4].strip() == "Tòa B1" %}
					<div class="printer-card" data-printer-id="{{ printer[0] }}">
						<img
							src="{{ url_for('static', filename='images/icon_printer.png') }}" />
						<p class="printer-id">B130{{ 10 + loop.index }}</p>
						<!-- Hiển thị ID tùy chỉnh -->
						{% if printer[1] == "Sẵn sàng" %}
						<p class="status status-available">SẴN SÀNG</p>
						{% elif printer[1] == "Đang in" %}
						<p class="status status-busy">ĐANG IN</p>
						{% elif printer[1] == "Vô hiệu hóa" %}
						<p class="status status-disabled">VÔ HIỆU HÓA</p>
						{% else %}
						<p class="status status-unknown">KHÔNG XÁC ĐỊNH</p>
						{% endif %}
					</div>
					{% endif %} {% endfor %}
				</div>
			</div>
			<!-- cấu hình máy in -->
			<div class="config-panel">
				<div class="header2">Cấu hình máy in</div>
				<div class="content">
					<img
						src="{{ url_for('static', filename='images/cauhinhmayin.png') }}"
						class="content-image"
						style="display: none" />
				</div>
				<div class="footer">
					<span>Vô hiệu hóa</span>
					<label class="switch">
						<input type="checkbox" id="disable-printer-switch" />
						<span class="slider"></span>
					</label>
				</div>
			</div>
			<!-- script hiện cấu hình in và vô hiệu hóa -->
			<script>
				document.addEventListener("DOMContentLoaded", function () {
					const printerCards = document.querySelectorAll(".printer-card");
					const contentImage = document.querySelector(".content-image");
					const disableSwitch = document.getElementById(
						"disable-printer-switch"
					);
					let selectedPrinter = null; // Biến lưu máy in đang chọn

					printerCards.forEach((printerCard) => {
						printerCard.addEventListener("click", function () {
							if (this.classList.contains("selected")) {
								// Bỏ chọn nếu nhấn vào máy in đang được chọn
								this.classList.remove("selected");
								selectedPrinter = null;
								contentImage.style.display = "none";
								disableSwitch.checked = false; // Reset trạng thái switch
								disableSwitch.disabled = true; // Disable switch
							} else {
								// Chọn máy in mới
								printerCards.forEach((card) =>
									card.classList.remove("selected")
								);
								this.classList.add("selected");
								selectedPrinter = this;

								const printerId = this.dataset.printerId; // Lấy ID máy in từ thuộc tính data
								const statusElement = this.querySelector(".status"); // Lấy trạng thái của máy in

								// Hiển thị hình ảnh cấu hình
								contentImage.src = `{{ url_for('static', filename='images/cauhinhmayin.png') }}`;
								contentImage.style.display = "block";

								// Cập nhật trạng thái công tắc
								if (statusElement.classList.contains("status-disabled")) {
									disableSwitch.checked = true; // Bật công tắc
								} else {
									disableSwitch.checked = false; // Tắt công tắc
								}

								disableSwitch.disabled = false; // Bật công tắc để có thể thao tác
							}
						});
					});

					// Lắng nghe thay đổi trạng thái của công tắc
					disableSwitch.addEventListener("change", function () {
						if (!selectedPrinter) return; // Nếu không có máy in nào được chọn

						const printerId = selectedPrinter.dataset.printerId; // Lấy ID của máy in được chọn
						const newStatus = this.checked ? "Vô hiệu hóa" : "Sẵn sàng"; // Tính trạng thái mới dựa trên công tắc

						// Cập nhật trạng thái giao diện
						const statusElement = selectedPrinter.querySelector(".status");
						if (this.checked) {
							statusElement.textContent = "VÔ HIỆU HÓA";
							statusElement.classList.remove("status-available", "status-busy");
							statusElement.classList.add("status-disabled");
						} else {
							statusElement.textContent = "SẴN SÀNG";
							statusElement.classList.remove("status-disabled", "status-busy");
							statusElement.classList.add("status-available");
						}

						// Gửi yêu cầu cập nhật trạng thái lên server (Flask)
						fetch("/update_printer_status", {
							method: "POST",
							headers: {
								"Content-Type": "application/json",
							},
							body: JSON.stringify({
								printer_id: printerId,
								status: newStatus,
							}),
						})
							.then((response) => response.json())
							.then((data) => {
								if (data.success) {
									console.log(
										`Máy in ${printerId} đã được cập nhật trạng thái.`
									);
								} else {
									console.log(
										`Lỗi khi cập nhật trạng thái máy in ${printerId}`
									);
								}
							})
							.catch((error) => {
								console.error("Có lỗi khi gửi yêu cầu:", error);
							});
					});
				});
			</script>
		</div>

		<!-- chatbox admin -->
		<div
			id="chat-icon"
			draggable="true"
			onmousedown="this.style.cursor='grabbing'"
			onmouseup="this.style.cursor='grab'"
			ondragstart="event.dataTransfer.setDragImage(new Image(), 0, 0);"
			ondrag="if(event.clientX > 0 && event.clientY > 0) { this.style.left = event.clientX - 25 + 'px'; this.style.top = event.clientY - 25 + 'px'; this.style.position='fixed'; }"
			onclick="document.getElementById('chat-box').style.display = 'flex';">
			💬
		</div>

		<!-- Chat Box -->
		<div id="chat-box">
			<!-- Chat List -->
			<div id="chat-list">
				<div class="chat-header">
					<span>Đoạn chat</span>
					<button
						onclick="document.getElementById('chat-box').style.display = 'none';">
						×
					</button>
				</div>
				<ul>
					<li onclick="openChat('Anh Khoa', 'Tôi cần hỗ trợ ở máy in số 4');">
						<img src="{{ url_for('static', filename='images/anhkhoa.png') }}" />
						<div>
							<span class="chat-name">Anh Khoa</span>
							<p class="chat-message">Tôi cần hỗ trợ...</p>
						</div>
					</li>
					<li
						onclick="openChat('Tiến Đạt', 'Tôi cần hỗ trợ với máy tính mạng');">
						<img src="{{ url_for('static', filename='images/dat.png') }}" />
						<div>
							<span class="chat-name">Tiến Đạt</span>
							<p class="chat-message">Tôi cần hỗ trợ...</p>
						</div>
					</li>
				</ul>
			</div>

			<!-- Chat Conversation -->
			<div id="chat-conversation" style="display: none">
				<div class="chat-header">
					<button onclick="backToChatList()">←</button>
					<span id="conversation-name"></span>
				</div>
				<div id="messages">
					<!-- Messages dynamically injected -->
				</div>
				<div class="chat-input">
					<input
						type="text"
						placeholder="Nhập tin nhắn..."
						id="message-input" />
					<button onclick="sendMessage()">Gửi</button>
				</div>
			</div>
		</div>
		<!-- script chatbox -->
		<script>
			const chatIcon = document.getElementById("chat-icon");
			const chatBox = document.getElementById("chat-box");
			const chatList = document.getElementById("chat-list");
			const chatConversation = document.getElementById("chat-conversation");
			const conversationName = document.getElementById("conversation-name");
			const messages = document.getElementById("messages");
			const messageInput = document.getElementById("message-input");

			let offsetX, offsetY;

			// Data for the messages
			const chatData = {
				"Anh Khoa": ["Tôi cần hỗ trợ ở máy in số 4", "Máy in bị lỗi giấy"],
				"Tiến Đạt": [
					"Tôi cần hỗ trợ với máy tính mạng",
					"Mạng bị ngắt kết nối",
				],
			};
			// Toggle chat box visibility
			function toggleChat() {
				chatBox.classList.toggle("hidden");
			}

			// Close chat box
			function closeChat() {
				chatBox.classList.add("hidden");
			}

			function openChat(name, initialMessage) {
				// Hide chat list and show chat conversation
				document.getElementById("chat-list").style.display = "none";
				document.getElementById("chat-conversation").style.display = "flex";

				// Set the conversation name
				document.getElementById("conversation-name").textContent = name;

				// Show all messages for the selected chat
				const messages = chatData[name]
					.map((message) => `<p><strong>${name}:</strong> ${message}</p>`)
					.join("");

				// Display all the messages
				document.getElementById("messages").innerHTML = messages;
			}

			// Back to the chat list
			function backToChatList() {
				document.getElementById("chat-conversation").style.display = "none";
				document.getElementById("chat-list").style.display = "block";
			}

			// Send message
			function sendMessage() {
				const text = document.getElementById("message-input").value.trim();
				if (text) {
					const message = `<p><strong>Bạn:</strong> ${text}</p>`;
					document.getElementById("messages").innerHTML += message;
					document.getElementById("message-input").value = "";
				}
			}

			// Dragging the chat icon
			function startDrag(e) {
				offsetX = e.clientX - chatIcon.offsetLeft;
				offsetY = e.clientY - chatIcon.offsetTop;
				chatIcon.style.cursor = "grabbing";
			}

			function endDrag(e) {
				chatIcon.style.left = `${e.clientX - offsetX}px`;
				chatIcon.style.top = `${e.clientY - offsetY}px`;
				chatIcon.style.cursor = "grab";
			}

			// Add click listener to open chat box
			chatIcon.addEventListener("click", toggleChat);
		</script>
	</body>
</html>
